#### mysql面试真题

- mysql你有了解么?mysql索引是怎么实现的

  - 哈希索引

  - BTree索引和B+Tree索引

    

- 为什么用b+树,不用[红黑树](),avl呢? 

  - bst不建议可能出现链化
  - avl虽然平衡,但是旋转频繁
  - rb解决频繁旋转,但是二叉,io频繁
  - B树,数据不下沉也存储数据,会导致索引存储量下降
  - b+树,数据存在叶子节点,并且还有底层链表存在

- 那你是认为b树不适合作为索引么?(面试官:其实这两个都作为索引,只不过各有优点的) 

  - 大坑!面试的时候不要把b树喷得一无是处,mongodb用的是b树
  - b树内,每个节点都存储数据,因此在查询单条数据的时候,有可能o(1)就查到,也有可能会更高,所以做单一数据查询时,b树平均性能更好,但是不适合做数据遍历操作
  - b+树,数据出现在叶子节点上,查询比较稳定,单一数据查询平均性能不如b树,但是数据便利又优点,叶子节点有指针相连,这个特性使得b+树非常适合做范围查询
  - 所以没准是Mysql数据遍历操作比较多,所以用b+,monnodb单一查询过多,用b
  - 为什么非关系型数据库用b,关系型用b+?
    - 在关系型数据中，遍历操作比较常见，因此采用B+树作为索引，比较合适。而在非关系型数据库中，单一查询比较常见，因此采用B树作为索引，比较合适。
    - https://zhuanlan.zhihu.com/p/107228878

- 怎么判断一个sql走没走索引,具体到刚才的数据结构,是怎么看走什么数据结构的? 

  - `explain select \* from zje；`

  - 主要关注的是，type 和 key：

    type = ALL ：表示全表扫描

    type = const ：表示通过索引一次就找到了

    

    key = NULL：表示没有使用索引

    key = primary ：表示使用了主键

    key一般=使用了主键/索引的名字

- 什么时候明明创建了索引,但是执行的时候并没有通过索引呢?

  - 优化器的优化策略

    - 这个成本的方案就是所谓的执行计划。优化过程大致如下：

      1、根据搜索条件，找出所有可能使用的索引

      2、计算全表扫描的代价

      3、计算使用不同索引执行查询的代价

      4、对比各种执行方案的代价，找出成本的那一个

      https://database.51cto.com/art/201907/599614.htm

- 分页的时候我们常用到limit oversize,在处理数据量特别大的情况下会出现什么问题么? 

  - 用户实时操作频繁,导致我们刚拿出limit0-5的数据,可能再拿5-10的数据,还是刚才的0-5的数据

  - 解决?

    - sql执行select的时候，是先进行where筛选在order by排序

    - 所以我们要用分页的方法来处理一批数据的时候，一定要确定我们的sql语句分页查询出来的数据是不会改变的。例如1中的问题，我们可以采用升序的方法(记录创建的时间升序?)，前面产生的数据顺序就不会改变。2的解决方法是可以去掉where判断条件，取出数据后，在代码里对value的值进行判断改变。或者先对数据进行排序取出，再筛选value的值。

    - https://blog.csdn.net/qq_25673113/article/details/72851038

    - 但是有可能记录同一时间出现,orderby时间,分页仍然出现问题

    - 

    - SQL中ORDER BY相同值结果乱序的具体原因

      查阅了Goole和相关资料，大概总结了这种情况的原因。其实发生这种现象是“故意”设计的。

      如果没有指定ORDER BY语句，则**SQL Server（或任何RDBMS）不保证以特定顺序返回结果**。 有些人认为，如果没有指定order by子句，行总是以聚簇索引顺序或物理磁盘顺序返回。 然而，这是不正确的，因为在查询处理期间可以改变行顺序的许多因素，例如并行的HASH连接是更改行顺序的操作符的一个很好的例子。

      如果指定ORDER BY语句，SQL Server将对行进行排序，并按请求的顺序返回。 但是，**如果该顺序不是确定性的，即可能有重复的值，则在每个具有相同值的组中，由于与上述相同的原因，该顺序是“随机的”**。

      确保确定性顺序的唯一方法是在ORDER BY子句中包含保证的唯一列或列组（例如主键）。

      https://blog.csdn.net/Soinice/article/details/84729296

- mysql的事务隔离级别? 

  * 读提交,读未提交,可重复读,串行化

- mysql innodb默认是那种事务隔离级别? 

  - 可重复读

- mysql中的锁有哪些锁? 

- 间隙锁怎么实现的? 

- 间隙锁作用于不同的索引会有不同的表现么?比如作用于文件索引和普通索引会有什么不同的表现?